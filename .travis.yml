sudo: false
language: go
matrix:
  allow_failures:
  - go: master
  include:
  - go: 1.6.x
  - go: tip
    env: SEND_COVERAGE=0
  - go: master
before_install:
- go get github.com/mattn/goveralls
- go get github.com/modocache/gover
- go get github.com/Masterminds/glide
install:
- make prepare
script:
- make fmt-check
- if ([ "$TRAVIS_GO_VERSION" != "1.5.4" ]); then make lint; fi
- make vet
- make test-cover
before_deploy:
- go get github.com/laher/goxc
- goxc -main-dirs-exclude=vendor
after_success:
- if ([ "$SEND_COVERAGE" == "1" ]); then gover && $HOME/gopath/bin/goveralls -service=travis-ci
  -coverprofile=gover.coverprofile; fi
os:
- linux
notifications:
  email: false
deploy:
  provider: releases
  file_glob: true
  file:
  - "$HOME/gopath/bin/konfigurator-xc/*/konfigurator_*.tar.gz"
  - "$HOME/gopath/bin/konfigurator-xc/*/konfigurator_*.deb"
  skip_cleanup: true
  on:
    tags: true
    branch: master
    go: 1.7.4
    repo: Wikia/konfigurator
  api_key:
    secure: tvoPuUoDoxAY8eP+e6Y20t6JHm0XQQnSlqpSiKycTwPI5fGAbhH2KExAh/qpXiEu6luHZv1COm10FsobpA+UZOAr7FmRb1LS/h+wBPZMkagJYBpTZ7xHfNYElXOTLomsaoYFJMfZSPaW4+x1gdYcSZd5uY7e59EvaVB9GWE6+AGX1M9W4wm3IxEFlY4wBCWYJn84X18wcWefPFzn4F0DoDWYetzTn5xWb29tR4DmrUxBtSH8ftoQewL/n17iN99t1Vi5IBs1fRmDVy9/jCvvPyBY4EeG38+f8ItPIK0fMxqtpzc0Aef6CcGEBhrGj/D+Nl5qhOnvVFMNa/AlqZDMhTC5rbUjkk465SL3ZdDJcj7gHPCaRE8Je7m9ohRHFjjfBI0MKuWrAwN/v7Y0bwBlHgrFpkcPfJb44mN2cQUZ8qhf9uFtOu6FGS0ScCZKoTQXLcIKq+2s1RF/ogJoTOwkovjuCg3RxE9CyTUJmaMvzB11ToP5AWQe46oNlrj65AQmtbbTNcnTq28r32o2d4EQHxaqEDtaAlsstH1YejvLimmzht0OJkoQHUWpKifVlmhQdMDEMFiIGf1vccoI8X8CA/K+/avX12jbSuSH7ZBHcb9BOmBnmCLO4ntuBJn10rdN2s8OmB2zYxot/UvAvWTWMF573iE64airFqb4Oib7ss0=
