sudo: false
language: go
matrix:
  allow_failures:
  - go: master
  include:
  - go: 1.5.4
    env: GO15VENDOREXPERIMENT=1
  - go: 1.6.x
  - go: tip
    env: SEND_COVERAGE=0
  - go: master
before_install:
- go get github.com/mattn/goveralls
- go get github.com/modocache/gover
- go get github.com/Masterminds/glide
install:
- make prepare
script:
- make fmt-check
- if ([ "$TRAVIS_GO_VERSION" != "1.5.4" ]); then make lint; fi
- make vet
- make test-cover
before_deploy:
- go get github.com/laher/goxc
- goxc goxc -main-dirs-exclude=vendor
after_success:
- if ([ "$SEND_COVERAGE" == "1" ]); then gover && $HOME/gopath/bin/goveralls -service=travis-ci
  -coverprofile=gover.coverprofile; fi
os:
- linux
notifications:
  email: false
deploy:
  provider: releases
  file_glob: true
  file:
  - "$HOME/gopath/bin/konfigurator-xc/*/konfigurator_*.tar.gz"
  - "$HOME/gopath/bin/konfigurator-xc/*/konfigurator_*.deb"
  skip_cleanup: true
  on:
    tags: true
    branch: master
    go: 1.7.4
    repo: Wikia/konfigurator
  api_key:
    secure: n4DWxL2ZXJNj6D08e5jnyEM4DB436Pq+uQNdd+whX2Um5EW0Pr0pMEtgbMuO6YR++p8obrg45iSi8eNSu+qzztSZUlrbFX7YZ4f5R/CBBYh2WX2mrGApJPzjgWE1lFnTY81+YOLgLg25WkqDu1Ki/6YCTlLpuKn9INZN4ijbRYu4x93vXCKdMVu9jmn1YiGJEiGGz1XyKsUZ77m5WOGLhBq0cZGSYEq0J+qKhydmeO1VgKF6wPZU627fM2MJbVjQ61UaSbeeTYbEMWkdrCb3UYiBOczyEUQx/GFGe47bcHRrBoJEaUjiWA7bp7/qB1t3nVnXYZ/aFDiWe5RC9oy0rywFfUbHjATz1PYV5hKqCUt83VdXw00ekkfXz1SAQYN0ONDAPSeusc0Rqf7jk+M+/VzZ5EVCi/UgJarYcGDy2CE37ZPlCiKXCDPBkAGt3DNIimCulDIjJcbuvNmTBXhzSHoCWOZfdxsEoK0+eM4r12j7iR4M83m0wkE+TWrlVPNy04d1uNHTJAA638jtLj9JvJbYla3Lf3ZvSFf3iIEgAPIr+qu50qrkeS2EpnMP+zzyYWMHjczH2F+H9OqlIE93aCA5nZ6TKq/Zjw1Tg9fGIxzRUkRaEJs/D/i0RBJj5XonlhYy2v7vUcCIwbZam5AcX2kLJZx7iRi996HMl3Apatk=
